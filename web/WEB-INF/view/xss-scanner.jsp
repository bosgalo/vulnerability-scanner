<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <title>Scanner</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.4/css/bootstrap.min.css"
          integrity="sha384-2hfp1SzUoho7/TsGGGDaFdsuuDL0LX2hnUp6VkX3CUQ2K4K+xjboZdsXyp4oUHZj" crossorigin="anonymous">
</head>
<body>
<form action="<c:url value="/xss-scanner"/>" method="post">
    <button type="submit">Scan!</button>
</form>
<table border="1" class="table table-bordered">
    <tr>
        <th>Destination Url</th>
        <th>Payload Url</th>
        <th>Method</th>
        <th>Is Vulnerable</th>
        <th colspan="2">Form Payload</th>
        <%--<th colspan="3">Action</th>--%>
    </tr>
    <c:forEach items="${scanResults}" var="scanResult">
        <tr>
            <td><a href="<c:out value="${scanResult.destinationUrl}"/>"><c:out
                    value="${scanResult.destinationUrl}"/></a></td>
            <td><c:out value="${scanResult.payloadUrl}"/></td>
            <td><c:out value="${scanResult.method}"/></td>
            <td><c:out value="${scanResult.isVulnerable}"/></td>

            <c:forEach items="${scanResult.formPayloads}" var="payload">
                <th>Input Name:</th>
                <td><c:out value="${payload.inputName}"></c:out></td>
                <th>Payload:</th>
                <td><c:out value="${payload.payload}"></c:out></td>
            </c:forEach>
        </tr>
    </c:forEach>
</table>
</body>
</html>
