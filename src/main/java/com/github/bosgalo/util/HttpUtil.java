package com.github.bosgalo.util;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.net.URL;
import java.net.URLConnection;

/**
 * Created by bosgalo on 26.05.2017.
 */
public class HttpUtil {

    public byte[] getContent(URL url) throws IOException {

        URLConnection urlConnection = url.openConnection();
        urlConnection.addRequestProperty("Cookie", "JSESSIONID=83CC704E4278770F962C42EBE160C57F");

        InputStream inputStream = urlConnection.getInputStream();

        int contentLength = urlConnection.getContentLength();

        if (contentLength == -1) {
            ByteArrayOutputStream buffer = new ByteArrayOutputStream();
            int readed;
            byte[] data = new byte[16000];

            while (true){
                readed = inputStream.read(data, 0, data.length);
                if (readed == -1) break;
                buffer.write(data, 0, readed);
            }
            buffer.flush();
            return buffer.toByteArray();
        }

        byte[] res = new byte[contentLength];
        int readed = 0;
        while (contentLength != readed){
            readed += inputStream.read(res, readed, contentLength);
        }

        return res;
    }
}
