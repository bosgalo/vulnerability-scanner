package com.github.bosgalo.scanner.xss;

import org.jsoup.Connection;
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.select.Elements;

import java.io.IOException;

public class Test {
    public void stert() throws IOException {
        Connection connection = Jsoup.connect("http://192.168.0.105:8082/vuln");

//        String maliciousJs = "alert('test')";
//        connection
//                .method(Connection.Method.POST)
//                .data("message", "<script>" + maliciousJs + "</script>")
//                .execute();
////        connect.cookie("JSESSIONID","D48E1C43687EBA6FA43248F2FFE184CB");
//        Document document = getDocument(connection);
//        Elements tdElementsByTag = document.getElementsByTag("td");
//        tdElementsByTag.forEach(element -> {
//            if (element.data().contains(maliciousJs)) System.out.println();
//        });

        findInputs(getDocument(connection));
    }

    private void findInputs(Document document) {
        Elements inputs = document.getElementsByTag("input");
        inputs.forEach(input -> System.out.println(input.attributes().get("name")));
    }

    private Document getDocument(Connection connect) {
        Document document = null;
        try {
            document = connect.get();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return document;
    }
}
